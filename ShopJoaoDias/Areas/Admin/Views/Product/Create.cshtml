@model ProductViewModel

@{
    var uploadViewModel = new UploadViewModel
            {
                Folder = "./Upload",
                MaxFiles = 1
            };

    var status = new List<SelectListItem>
    {
        new SelectListItem{Text = "", Value = "1"}
    };
}

<div class="row">
    @if (ViewBag.error != null)
    {
        <div class="alert">
            <div class="alert-danger">
                @ViewBag.error
            </div>
        </div>
    }
    <div class="col-lg-12">
        <div class="card" id="app">
            <div class="card-body">
                <h4 class="card-title">Create a new Bank</h4>
                <form class="form-horizontal p-t-20" method="post">
                    <div class="form-group row">
                        <div class="col-md-3">
                            <label asp-for="@Model.ProductDO.Category" class="control-label font-weight-bold pt-1">Parent Category</label>
                        </div>
                        <div class="col-md-6">
                            <select class="form-control" v-model="parentid" v-on:change="getSub">
                                <option value="">Select a Category</option>
                                <option v-for="item in parents" v-bind:value="item.id">{{item.name}}</option>
                            </select>
                            <span class="text-danger field-validation-valid"
                                  asp-validation-for="@Model.ProductDO.Category" data-valmsg-replace="true">
                            </span>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-md-3">
                            <label asp-for="@Model.ProductDO.Category" class="control-label font-weight-bold pt-1">Sub Category</label>
                        </div>
                        <div class="col-md-6">
                            <select class="form-control" v-model="categoryid">
                                <option value="">Select a Category</option>
                                <option v-for="item in subs" v-bind:value="item.id">{{item.name}}</option>
                            </select>
                            <span class="text-danger field-validation-valid"
                                  asp-validation-for="@Model.ProductDO.Category" data-valmsg-replace="true">
                            </span>
                        </div>
                    </div>
                    <spselect asp-for="@Model.ProductDO.Brand"
                              asp-items="@(new SelectList(Model.BrandList, "Id", "Name"))" asp-text="Select a Brand">
                    </spselect>
                    <spinput asp-for="@Model.ProductDO.Name"></spinput>
                    <spinput asp-for="@Model.ProductDO.Barcode"></spinput>
                    <spinput asp-for="@Model.ProductDO.Code"></spinput>
                    <spinput asp-for="@Model.ProductDO.Price"></spinput>
                    <spcheckbox asp-items="status" asp-for="@Model.ProductDO.Returnable"></spcheckbox>
                    <spcheckbox asp-items="status" asp-for="@Model.ProductDO.Stock"></spcheckbox>
                    <spcheckbox asp-items="status" asp-for="@Model.ProductDO.Showcase"></spcheckbox>
                    <spcheckbox asp-items="status" asp-for="@Model.ProductDO.Homepage"></spcheckbox>
                    <spcheckbox asp-items="status" asp-for="@Model.ProductDO.Categorygold"></spcheckbox>
                    <spinput asp-for="@Model.ProductDO.Returnableday"></spinput>
                    <spinput asp-for="@Model.ProductDO.Description"></spinput>
                    <spinput asp-for="@Model.ProductDO.Pagetitle"></spinput>
                    <spinput asp-for="@Model.ProductDO.Metadescription"></spinput>
                    <spinput asp-for="@Model.ProductDO.Easyurl"></spinput>
                    <spinput asp-for="@Model.ProductDO.Hit"></spinput>
                    <spupload></spupload>
                    <spinput asp-for="@Model.ProductDO.Image" addclass="image" type="hidden"></spinput>
                    <spbutton asp-value="Create"></spbutton>
                </form>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_singleUpload" model="uploadViewModel"></partial>
    <script src="~/js/vue/vue.js"></script>
    <script src="~/js/axios/axios.min.js"></script>

    <script>
        new Vue({
            el: "#app",
            data: {
                parents: @Html.Raw(Json.Serialize(Model.CategoryList)),
                subs: [],
                categoryid: 0,
                parentid: 0
            },

            methods: {
                getSub: function () {
                    if (this.parentid) {
                        axios.get("./SubCategories/" + this.parentid).then(response => {
                            this.subs = response.data;
                        });
                    }
                }
            }
        })
    </script>
}